---
description: 敏感信息保护和文档规范
alwaysApply: true
---

# 敏感信息保护规则

## 🔒 核心原则

**绝对禁止在任何文件中直接写入明文敏感信息**，包括但不限于：
- IP 地址
- 域名
- API 密钥
- 服务器凭证
- 数据库密码

### 规则文件与示例的脱敏要求

- **本规则文件及所有 `.cursor/rules`、文档、示例代码**中，均不得写入任何具体敏感信息（包括真实或“仅作示例”的 IP、域名、API 密钥等）。
- **错误示例**只使用抽象占位符（如 `<IP>`、`<域名>`、`<API_KEY>`）或文字描述（如「某域名」「某IP」），不写可被复制使用的具体值。
- 不得用 192.0.2.x、example.com、sk-xxxx 等“看起来像示例”的具体值充当错误示例；占位符统一用尖括号或变量名（如 `YOUR_SERVER_IP`）。

## ✅ 正确做法

### 1. 环境变量引用

在代码和脚本中，**必须使用环境变量**：

```bash
# ✅ 正确
SERVER_IP="${SERVER_IP:-YOUR_SERVER_IP}"
ssh $SERVER_USER@$SERVER_IP

# ❌ 错误 - 不要写死 IP
ssh root@<IP>
```

```javascript
// ✅ 正确
const apiKey = process.env.DEEPSEEK_API_KEY;

// ❌ 错误 - 不要硬编码密钥
const apiKey = '<API_KEY>';
```

### 2. 文档中的敏感信息

在 Markdown 文档中描述配置时，**使用占位符或变量名**：

```markdown
# ✅ 正确
**部署目标**: https://${BASE_DOMAIN}
**服务器**: ${SERVER_USER}@${SERVER_IP}
**API Key**: ${DEEPSEEK_API_KEY}

# ❌ 错误 - 不要写死域名、IP、密钥
**部署目标**: https://<域名>
**服务器**: root@<IP>
**API Key**: <API_KEY>
```

### 3. 示例配置文件

创建 `.example` 后缀的模板文件：

- `.env.example` - 使用占位符如 `YOUR_SERVER_IP`、`YOUR_API_KEY`
- `config.example.json` - 不包含真实值

### 4. 日志和测试输出

```bash
# ✅ 正确 - 部分遮蔽
echo "API Key: ${apiKey:0:10}..."

# ❌ 错误 - 完整输出
echo "API Key: $apiKey"
```

## 📋 检查清单

在创建或修改文件前，确认：

- [ ] 所有 IP 地址已替换为 `${SERVER_IP}` 或 `YOUR_SERVER_IP`
- [ ] 所有域名已替换为 `${BASE_DOMAIN}` 或占位符
- [ ] 所有 API 密钥已替换为环境变量或占位符，无明文
- [ ] 脚本使用环境变量而非硬编码
- [ ] 文档中的示例使用占位符
- [ ] 规则文件与示例中未包含任何具体 IP、域名、密钥（错误示例仅用 `<IP>`、`<域名>`、`<API_KEY>` 或文字描述）

## 🔍 常见场景

### Shell 脚本

```bash
# 从 .env 加载变量
if [ -f .env ]; then
  export $(grep -v '^#' .env | xargs)
fi

# 使用变量并提供默认占位符
SERVER_IP="${SERVER_IP:-YOUR_SERVER_IP}"
```

### 部署文档

```markdown
## 部署配置

服务器: `${SERVER_USER}@${SERVER_IP}`
域名: `${BASE_DOMAIN}`

请在 `.env` 文件中配置实际值。
```

### 测试脚本

```bash
# 从环境变量读取
BASE_URL="${BASE_URL:-https://YOUR_DOMAIN}"

# 输出时脱敏
echo "测试域名: ${BASE_URL}"
```

## ⚠️ 违规示例

以下是**禁止**的写法：

```markdown
❌ 在文档/代码中写死 URL（如 https://某域名）
❌ 在脚本中写死 ssh user@某IP
❌ 在代码中写死 API_KEY=某密钥
❌ 在配置中写死 SERVER_IP=某IP
```

## 🎯 快速修复指南

发现明文敏感信息时：

1. **立即替换**为环境变量或占位符
2. **检查 Git 历史**，考虑是否需要清理提交记录
3. **更新 .env.example**，确保模板是脱敏的
4. **轮换凭证**（如果已泄露到公开仓库）
